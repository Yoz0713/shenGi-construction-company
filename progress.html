<!DOCTYPE html>
<html lang="zh-tw">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Noto+Serif+TC:wght@300;400;500;600;700;900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;600;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./style/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.css">
    <link rel="stylesheet" href="./css/loading-bar.css">
    <title>森鉅建設</title>
</head>

<body>
    <!-- loading畫面 -->
    <div class="loading-bg">

    </div>
    <!-- loading畫面 -->
    <header>
        <div class="logoBox">
            <a href="./index.html">
                <img src="./img/index/svg/logo.svg" alt="logo">
            </a>

        </div>
        <div class="toolBox">
            <a id="login_a" href="login.html">會員登入</a>
            <div class="user-area ">
                <div class="user-area-button">
                    <img src="./img/config/user.svg">
                    <p>測試會員 </p>
                    <img src="./img/config/header-arrow.svg" class="arrow">
                </div>

                <div class="user-area-menu">
                    <ul>
                        <li><a href="./user.html">會員專區</a></li>
                        <li><a href="./service.html">客服維修</a></li>
                        <li><a id="logout_btn" href="javascript:;">會員登出</a></li>
                    </ul>
                </div>
            </div>

            <div class="menu-button">
                <p>．</p>
                <p>Menu</p>
            </div>
        </div>

    </header>
    <div class="menu">
        <div class="close">
            <img src="./img/config/bx_x.svg" alt="x">
        </div>
        <ul>
            <li>

                關於森鉅
                <span>Sun Glory</span>

                <ul class="sub-open">
                    <li> <a href="./concept.html">
                            品牌理念
                            <span>Concept</span>
                        </a> </li>
                    <li> <a href="./company.html">
                            營造公司
                            <span>Company</span>
                        </a> </li>
                    <li><a href="./smart.html">
                            科技智慧宅
                            <span>Smart Home</span>
                        </a> </li>
                </ul>
            </li>
            <li>
                <a href="./constrction.html" class="sub">
                    熱銷建案
                    <span>Construction</span>
                </a>

            </li>
            <li>
                <a href="./portfolio.html" class="sub">
                    經典業績
                    <span>Portfolio</span>
                </a>

            </li>
            <li>
                <a href="./contact.html" class="sub">
                    聯絡我們
                    <span>Contact Us</span>
                </a>

            </li>

        </ul>
    </div>
    <section class="progress">
        <section class="first-page">
            <div class="first-page-title">
                <h3>PROGRESS</h3>
                <h2>工程進度</h2>
            </div>
            <div class="first-page-bg">
                <img src="./img/progress/first-page-bg.webp">
            </div>
            <div class="caseName">
                <h2>之間</h2>
            </div>
        </section>
        <section class="progress-bar">
            <ul>
                <li>
                    <p>地下基礎工程</p>
                    <div class="bar-container">
                        <div class="bar"></div>
                    </div>
                </li>
                <li>
                    <p>地上基礎工程</p>
                    <div class="bar-container">
                        <div class="bar"></div>
                    </div>
                </li>
                <li>
                    <p>水電設備工程</p>
                    <div class="bar-container">
                        <div class="bar"></div>
                    </div>
                </li>
                <li>
                    <p>外部裝修工程</p>
                    <div class="bar-container">
                        <div class="bar"></div>
                    </div>
                </li>
                <li>
                    <p>內部裝修工程</p>
                    <div class="bar-container">
                        <div class="bar"></div>
                    </div>
                </li>
            </ul>
        </section>
        <main>
            <div class="content">
                <div class="title">
                    <p><span>10月</span>大底灌漿</p>
                    <p>工程進度 : <span class="schedule">80%</span></p>
                </div>
                <div class="content-left">
                    <div class="swiper swiper1 swiper-no-swiping">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide1.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide2.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide3.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide4.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide5.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide6.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide4.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide5.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide6.webp">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-right">
                    <img src="./img/progress/slide1.webp" class="is-active">
                    <img src="./img/progress/slide2.webp">
                    <img src="./img/progress/slide3.webp">
                    <img src="./img/progress/slide4.webp">
                    <img src="./img/progress/slide5.webp">
                    <img src="./img/progress/slide6.webp">
                    <img src="./img/progress/slide4.webp">
                    <img src="./img/progress/slide5.webp">
                    <img src="./img/progress/slide6.webp">
                    <img src="./img/progress/slide6.webp">
                    <div class="more">
                        <p>更多</p>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="title">
                    <p><span>9月</span>鋼筋綁紮</p>
                    <p>工程進度 : <span class="schedule">80%</span></p>
                </div>
                <div class="content-left">
                    <div class="swiper swiper1 swiper-no-swiping">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide1.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide2.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide3.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide4.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide5.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide6.webp">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-right">
                    <img src="./img/progress/slide1.webp" class="is-active">
                    <img src="./img/progress/slide2.webp">
                    <img src="./img/progress/slide3.webp">
                    <img src="./img/progress/slide4.webp">
                    <img src="./img/progress/slide5.webp">
                    <img src="./img/progress/slide6.webp">
                    <div class="more">
                        <p>更多</p>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="title">
                    <p><span>8月</span>第二層出土完成</p>
                    <p>工程進度 : <span class="schedule">80%</span></p>
                </div>
                <div class="content-left">
                    <div class="swiper swiper1 swiper-no-swiping">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide1.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide2.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide3.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide4.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide5.webp">
                                </div>
                            </div>
                            <div class="swiper-slide">
                                <div class="imgBox">
                                    <img src="./img/progress/slide6.webp">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-right">
                    <img src="./img/progress/slide1.webp" class="is-active">
                    <img src="./img/progress/slide2.webp">
                    <img src="./img/progress/slide3.webp">
                    <img src="./img/progress/slide4.webp">
                    <img src="./img/progress/slide5.webp">
                    <img src="./img/progress/slide6.webp">
                    <div class="more">
                        <p>更多</p>
                    </div>
                </div>
            </div>
            <div class="pop-up">
                <div class="pop-up-close">
                    <img src="./img/config/bx_x.svg" alt="x">
                </div>
                <div class="pop-up-content">
                    <div class="title">
                    </div>
                    <div class="pop-up-content-top">
                        <div class="swiper swiper swiper-no-swiping">
                            <div class="swiper-wrapper">

                            </div>
                        </div>
                    </div>
                    <div class="pop-up-content-bottom">
                    </div>
                </div>
            </div>
        </main>
    </section>

    <footer>
        <p class="computer">Copyright © 2023 森鉅建設股份有限公司版權所有<span>TEL：02-8776-2086</span>地址：臺北市松山區敦化北路167號17樓</p>
        <p class="phone">森鉅建設股份有限公司版權所有 2023 © Copyright<br>
            02-8776-2086 臺北市松山區敦化北路167號17樓</p>
    </footer>

    <script src="./js/splitText.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/ScrollTrigger.min.js"></script>
    <script src="./js/config.js"></script>

    <script>

        window.onload = function () {
            setTimeout(() => {
                $(".loading-bg").css("opacity", "0")
            }, 650)

            popUpImg()

            const swiper1 = new Swiper(".content .swiper1", {
                effect: 'fade',
                fadeEffect: {
                    crossFade: true,
                },

                speed: 1000,
            })
            const swiper2 = new Swiper(".pop-up .swiper", {
                effect: 'fade',
                fadeEffect: {
                    crossFade: true,
                },

                speed: 1000,
            })
            //點小圖換輪播圖

            function thumbs() {

                $(".content-right").each((i, item) => {
                    $(item.children).each((j, item) => {
                        $(item).click(function (e) {
                            if ((item.nodeName).toUpperCase() == "IMG") {
                                swiper1[i].slideTo(j)
                                $(item).parent().find("img").removeClass("is-active")
                                $(item).addClass("is-active")
                            }

                        })
                    })
                })


            }
            thumbs()


            function more() {


                //當圖片超過九個時顯示'更多'按鈕
                $(".content-right").each((i, item) => {
                    if (item.childElementCount >= 11) {
                        $(item).addClass("more-active")
                    }
                })



                //pop up 

                $(".content .more").click((e) => {
                    //視窗開啟
                    $(".pop-up").addClass("pop-up-active")
                    //視窗開啟時 禁用body的滾動
                    $("body").addClass("body-noscroll")


                })


                $(".pop-up-close").click(() => {
                    //視窗關閉
                    $(".pop-up").removeClass("pop-up-active")
                    //視窗關閉時 開啟body的滾動
                    $("body").removeClass("body-noscroll");

                })
            }
            more()



            //視窗開啟時，抓取當月進度欄位的圖片(包含輪播圖、小圖及title)塞入pop up視窗
            function popUpImg() {
                //pop up part
                let insert = new Promise((resolve, reject) => {
                    $(".content .more").each((i, item) => {
                        $(item).click((e) => {

                            //輪播圖抓取
                            let slide = [];
                            $($(".content")[i]).find(".swiper-slide").children().each((j, item) => {
                                slide.push(`<div class="swiper-slide">${$($(item))[0].outerHTML}</div>`)
                            })

                            for (let j = 0; j < $($(".content")[i]).find(".swiper-slide").length; j++) {


                                $(".pop-up .swiper-wrapper").append(slide[j])
                                swiper2.slideTo(0)
                            }
                            //小圖抓取
                            let slide2 = []
                            $($(".content")[i]).find(".content-right img").each((j, item) => {

                                slide2.push(`${$($(item))[0].outerHTML}`)

                            })

                            for (let j = 0; j < $($(".content")[i]).find(".content-right img").length; j++) {

                                $(".pop-up-content-bottom").append(slide2[j])
                                $(".pop-up-content-bottom").children().each((i, item) => {
                                    if (i !== 0) {
                                        $($(".pop-up-content-bottom").children()[i]).removeClass("is-active")
                                    } else {
                                        $($(".pop-up-content-bottom").children()[i]).addClass("is-active")
                                    }
                                })
                            }

                            //title 抓取
                            console.log($($($(".content")[i]).find(".title")[0]).children().html())
                            $(".pop-up .title").append(`${$($($(".content")[i]).find(".title")[0]).html()}`)



                            resolve()
                        })
                    })
                }).then(() => {
                    $(".pop-up-content-bottom img").each((i, item) => {

                        // $(item).on("click", function (e) {
                        //     console.log(e)
                        //     if ((item.nodeName).toUpperCase() == "IMG") {
                        //         swiper2.slideTo(i)
                        //         $(item).parent().find("img").removeClass("is-active")
                        //         $(item).addClass("is-active")
                        //     }
                        // })
                        $(".pop-up-content-bottom").on("click", (e) => {

                            if (e.target == $($(".pop-up-content-bottom img")[i])[0]) {
                                swiper2.slideTo(i)
                                $($($(".pop-up-content-bottom img")[i])[0]).addClass("is-active").parent().find("img").removeClass("is-active")
                                $($($(".pop-up-content-bottom img")[i])[0]).addClass("is-active")
                            }

                        })
                    })
                })

                //關閉視窗時清除圖片內容
                $(".pop-up-close").click(() => {
                    setTimeout(() => {
                        $(".pop-up .swiper-wrapper").empty()
                        $(".pop-up-content-bottom").empty()
                        $(".pop-up .title").empty()
                    }, 450)

                })
            }

            //拆分文字
            function split() {
                splitText(".first-page-title h3")
                splitText(".first-page-title h2")
                splitText(".first-page .caseName h2")
            }
            split()
            //動畫
            function bannerIn() {
                let gg = gsap.timeline()
                gg.fromTo(".first-page-bg", {
                    clipPath: "polygon(0 0 , 0% 0, 0% 90% , 0 90% , 0 0 )",

                }, {
                    clipPath: "polygon(0 0 , 100% 0, 100% 100% , 0 100% , 0 0 )",
                    duration: 1.4,
                }).fromTo(".first-page-bg img", {
                    scale: 1.3
                }, {
                    scale: 1,
                    duration: 1.3,
                    onStart: () => {
                        setTimeout(() => {
                            $(".first-page-title").addClass("is-active")
                            $(".first-page .caseName").addClass("is-active")
                        }, 500)
                    }
                }, "<+1").from(".first-page-title h3 span", {
                    opacity: 0,
                    x: 30,
                    duration: 0.8,
                    stagger: 0.03
                }, "<+0.5").from(".first-page-title h2 span", {
                    opacity: 0,
                    x: -30,
                    duration: 0.8,
                    stagger: 0.03,

                }, "<").from(".first-page .caseName h2 span", {
                    opacity: 0,
                    x: -30,
                    duration: 0.8,
                    stagger: 0.03,

                }, "<")
            }
            bannerIn()
            function mainPageAnimation() {
                $("main .content").each((i, item) => {
                    this[`gg+${i}`] = gsap.timeline({
                        scrollTrigger: {
                            trigger: item,
                            start: "top 50%"
                        }
                    })

                    this[`gg+${i}`].from($(item).find(".title"), {
                        opacity: 0,
                        y: 30,
                        duration: 0.8
                    }).from($(item).find(".swiper1 .imgBox"), {
                        opacity: 0,
                        y: 30,
                        duration: 0.8
                    }, "<+0.5").from($(item).find(".swiper1 .imgBox img"), {
                        scale: 1.1,
                        duration: 1.5
                    }, "<+0.5").from($(item).find(".content-right"), {
                        opacity: 0,
                        y: 30,
                        duration: 0.8,
                    }, "<+0.5").from($(item).find(".content-right .more"), {
                        scaleX: 0,
                        duration: 1,
                    }, "<+0.5").from($(item).find(".content-right .more p"), {
                        opacity: 0,
                        y: 30,
                        duration: 0.8,
                    })
                })
            }
            mainPageAnimation()


            //progress 進度條
            function persentageSetting(i, num) {
                let bar = document.querySelectorAll(".progress-bar .bar")
                bar[i].dataset.persent = `${num}%`
                bar[i].style.width = `${num}%`
            }
            //進度條長度依序往下設定 (index,num)
            //1.
            persentageSetting(0, 90)
            //2.
            persentageSetting(1, 80)
            //3.
            persentageSetting(2, 70)
            //4.
            persentageSetting(3, 60)
            //5.
            persentageSetting(4, 50)
        }
    </script>
</body>

</html>